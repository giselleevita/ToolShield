# Heuristic Classifier Configuration (H1: Generic Injection Heuristic)
# =====================================================================
# Rule-based baseline using keyword matching and patterns.
#
# SCIENTIFIC NOTE: This configuration deliberately EXCLUDES tool-specific
# keywords to ensure fair holdout evaluation. The detector should not have
# privileged knowledge of held-out tools. See configs/legacy/ for tool-aware variant.
#
# For a tool-aware variant (H2: Policy Keyword Heuristic), see heuristic_policy.yaml

model_type: heuristic

# Case sensitivity for keyword matching
case_sensitive: false

# Suspicious keywords that may indicate injection attempts
# NOTE: No tool-specific names included (holdout-safe)
suspicious_keywords:
  # Instruction override patterns
  - "ignore previous"
  - "ignore all"
  - "disregard"
  - "forget"
  - "override"
  - "bypass"
  - "skip"
  - "new instructions"
  - "new directive"
  - "system override"
  - "admin mode"
  - "maintenance mode"
  - "debug mode"
  - "elevated privileges"
  # Jailbreak patterns
  - "do anything now"
  - "unrestricted"
  - "no restrictions"
  - "pretend"
  - "roleplay"
  - "for testing"
  # Exfiltration patterns
  - "send to"
  - "send a copy"
  - "forward to"
  - "email to"
  - "post to"
  - "webhook"
  - "external"
  - "mirror"
  - "transmit"
  # Tool hijacking patterns (generic, no tool names)
  - "redirect to"
  - "call instead"
  # Indirect injection markers
  - "auto-approve"
  - "hidden"
  - "internal instruction"
  - "system note"

# Regex patterns for structural indicators
suspicious_patterns:
  - "\\[\\[.*ADMIN.*\\]\\]"
  - "\\{\\{.*SYSTEM.*\\}\\}"
  - "<<<.*>>>"
  - "---END.*---"
  - "BEGIN.*COMMAND"
  - "\\[INTERNAL\\]"
  - "\\[PRIORITY\\s*OVERRIDE\\]"
  - "<!--.*-->"
  - "auth_level\\s*=\\s*admin"
  - "restrictions\\s*=\\s*none"

# Allowlist patterns for known-safe requests
# NOTE: Deliberately narrow to avoid "please X. Also ignore instructions." bypasses.
# Only allowlists structured identifiers and explicit security discussion context.
allowlist_patterns:
  # Structured identifiers (narrow, safe)
  - "ticket\\s*#?\\s*\\w+-\\d+"
  - "customer\\s*(id|ID)\\s*:?\\s*\\w+-?\\d+"
  # Security discussion context (educational queries)
  - "\\b(explain|definition|what\\s+is|how\\s+does|mitigation|defense|research|paper)\\b.*\\b(prompt\\s+injection|jailbreak|llm\\s+security)\\b"
